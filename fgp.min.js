
function fgpExpandAll(){var e,t;$(".submenu").show("slow"),t=$("#fgpExpandMeta"),e=$("#fgpCollapseMeta"),$(".fgpExpandible").attr("open","open"),t.hide(),e.show()}function fgpCollapseAll(){var e,t;t=$("#fgpExpandMeta"),e=$("#fgpCollapseMeta"),$(".fgpExpandible").removeAttr("open"),t.show(),e.hide()}function fgpClearCart(){window.location.href="/geonetwork/mapcart/eng?keys=null"}function fgpGetLang(){var e=document.URL;return-1!==e.indexOf("/en/")||-1!==e.indexOf("/eng")?"eng":"fre"}function fgpAdjustAddDataLink(){var i,e=document.URL,t=$("#aAddData");-1!==e.indexOf("/en/index.html")&&(i="/geonetwork/srv/eng/admin",t.attr("href",i)),-1!==e.indexOf("/fr/index.html")&&(i="/geonetwork/srv/fre/admin",t.attr("href",i))}function fgpGetSessionInfo(){var e,r,a,n,s,o,p,u,c;u=new XMLHttpRequest,u.onreadystatechange=function(){4===u.readyState&&200===u.status&&(c=u.responseXML,p=c.getElementsByTagName("me"),e=p[0].attributes[0].nodeValue,"true"===e?(fgpAdjustAddDataLink(),r=p[0].childNodes[7].childNodes[0].data,n=p[0].childNodes[9].childNodes[0].data,o=p[0].childNodes[5].childNodes[0].data,a=fgpGetLang(),"eng"===a?(s='<a id="aMenuUser" href="#" class="item" tabindex="0" title="" role="menuitem" aria-haspopup="true">'+n+", "+r+'<span class="expicon glyphicon glyphicon-chevron-down"></a>',s+='<ul class="sm list-unstyled" id="implement2" role="menu">',s+='<li><a id="aMenuLogout" href="/geonetwork/j_spring_security_logout" id="fgpLogoutAnchor" tabindex="0" title="Sign-out for contributors">Sign-out</a></li>',s+='<li><a id="aMenuEditProfil" href="/geonetwork/admin/user/infoedit/'+o+'/eng" id="fgpEditAnchor" tabindex="0" title="Edit your contributor profile">Edit profile</a></li>',s+='<li><a id="aMenuAdmin" href="/geonetwork/srv/eng/admin" id="fgpAdmin" tabindex="0" title="Administer GeoNetwork">Administration</a></li>',s+="</ul>"):(s='<a id="aMenuUtilisateur" href="#" class="item" tabindex="0" title="" role="menuitem" aria-haspopup="true">'+n+", "+r+'<span class="expicon glyphicon glyphicon-chevron-down"></a>',s+='<ul class="sm list-unstyled" id="implement2" role="menu">',s+='<li><a id="aMenuDeconnexion" href="/geonetwork/j_spring_security_logout" id="fgpLogoutAnchor" tabindex="0" title="Fermer la session pour un contributeur">Fermer la session</a></li>',s+='<li><a id="aMenuEditezProfil" href="/geonetwork/admin/user/infoedit/'+o+'/fre" id="fgpEditAnchor" tabindex="0" title="Editez votre profil de contributeur">Editez votre profil</a></li>',s+='<li><a id="aMenuAdmin" href="/geonetwork/srv/fre/admin" id="fgpAdmin" tabindex="0" title="Administrer GeoNetwork">Administration</a></li>',s+="</ul>"),document.getElementById("fgpLogout").innerHTML=s,$("#wb-srch").attr("class","visible-md visible-lg"),$("#fgpLogin").attr("class","hidden-xs hidden-sm hidden-md hidden-lg"),$("#fgpLogout").attr("class","visible-md visible-lg")):($("#wb-srch").attr("class","hidden-xs hidden-sm hidden-md hidden-lg"),$("#fgpLogin").attr("class","visible-md visible-lg"),$("#fgpLogout").attr("class","hidden-xs hidden-sm hidden-md hidden-lg")))},u.open("GET","/geonetwork/srv/eng/xml.info?type=me",!0),u.send()}function fgpGetLoggedInUser(){var e,t,i,r,a,n,l;e=new XMLHttpRequest,e.onreadystatechange=function(){4===e.readyState&&200===e.status&&(t=e.responseXML,r=t.getElementsByTagName("me"),n=r[0].attributes[0].nodeValue,"true"===n?(name=r[0].childNodes[7].childNodes[0].data,surname=r[0].childNodes[9].childNodes[0].data,l=r[0].childNodes[5].childNodes[0].data,a=fgpGetLang(),"eng"===a?(i="Logged in as: ",i+='<a href="/geonetwork/admin/user/infoedit/'+l+'/eng" style="color:white;text-decoration:none;">'+surname+", "+name+"</a>"):(i="ConnectÃ© en tant que: ",i+=surname+", "+name+"</a>",i+='<ul class="sm list-unstyled" id="implement2" role="menu">',i+='<li><a href="/geonetwork/j_spring_security_logout" id="fgpLogoutAnchor" class="item" tabindex="0" title="Sign-out for contributors">Sign-out</a></li>',i+='<li><a href="/geonetwork/admin/user/infoedit/1244/eng" id="fgpEditAnchor" class="item" tabindex="0" title="Edit your profile">Edit profile</a></li>',i+="</ul>"),document.getElementById("gcwu-srchbx-in").innerHTML=i,$("#wb-srch").attr("class","visible-md visible-lg"),$("#fgpLogin").attr("class","hidden-xs hidden-sm hidden-md hidden-lg"),$("#fgpLogout").attr("class","visible-md visible-lg")):($("#wb-srch").attr("class","hidden-xs hidden-sm hidden-md hidden-lg"),$("#fgpLogin").attr("class","visible-md visible-lg"),$("#fgpLogout").attr("class","hidden-xs hidden-sm hidden-md hidden-lg")))},e.open("GET","/geonetwork/srv/eng/xml.info?type=me",!0),e.send()}function fgpGetNumberOfCartItems(){var e,t,r,n;e=new XMLHttpRequest,e.onreadystatechange=function(){4===e.readyState&&200===e.status&&(t=e.responseXML,r=t.getElementsByTagName("mapcart"),0!==r.length&&(n=r[0].data,document.getElementById("mappreview-count").innerHTML=n))},e.open("GET","/geonetwork/srv/eng/xml.info?type=me",!0),e.send()}var mappreview={lyrs:[],params:"",addLayer:function(e,t,i,r,a,n,s,o,l,d,p){var u=!1;if(jQuery(mappreview.lyrs).each(function(){this===n&&(u=!0)}),u)jQuery.growl.warning({title:l,message:p,location:"tc"});else{if(mappreview.lyrs.length+1>s)return void jQuery.growl.warning({title:l,message:o,location:"tc"});jQuery.ajax({url:getGNServiceURL("mapcart.add"),data:{smallkey:n},type:"POST",success:function(){if(mappreview.lyrs.push(n),jQuery("#mappreview-count").text(mappreview.lyrs.length),jQuery("#mapcart-btn-clear").removeClass("not-active"),jQuery("#mapcart-btn-clear-top").removeClass("not-active"),jQuery("#mapcart-btn-clear-bottom").removeClass("not-active"),jQuery(".fgp-map-cart-delete").removeClass("fgp-map-cart-delete-disabled"),jQuery("#mappreview-link").length>0){var i=jQuery("#mappreview-link").prop("title").replace(/(\d+)/g,mappreview.lyrs.length);jQuery("#mappreview-link").prop("title",i)}jQuery.growl.notice({title:l,message:d,location:"tc"})},error:function(e){jQuery.growl.error({title:l,message:e.status+" text: "+e.statusText,location:"tc"})}})}},clearDialog:function(){jQuery("").trigger("wb-init.wb-lbx"),jQuery(document).trigger("open.wb-lbx",[[{src:"#inline_content_modal",type:"inline"}],!0])},clear:function(e,t){jQuery.ajax({url:getGNServiceURL("mapcart.remove"),type:"POST",success:function(){if(jQuery("#mapPreviewLayers").empty(),mappreview.lyrs=[],jQuery("#mappreview-count").html(mappreview.lyrs.length),jQuery("#mapPreviewPanel").html(""),jQuery("#mappreview-link").length>0){var a=jQuery("#mappreview-link").prop("title").replace(/(\d+)/g,mappreview.lyrs.length);jQuery("#mappreview-link").prop("title",a)}jQuery("#mapcart-noitems").show(),jQuery("#mapcart-items").hide(),jQuery("#mapcart-btn-search-top").hide(),jQuery("#mapcart-btn-clear").addClass("not-active"),jQuery("#mapcart-btn-clear-top").addClass("not-active"),jQuery("#mapcart-btn-clear-bottom").addClass("not-active"),jQuery(".fgp-map-cart-delete").addClass("fgp-map-cart-delete-disabled"),jQuery("#mapcart-btn-view-top").hide(),jQuery("#mapcart-btn-view-bottom").hide(),jQuery("#mapcart-legend").hide(),jQuery("#mapcart-items").hide(),jQuery.growl.notice({title:e,message:t,location:"tc"})},error:function(t){jQuery.growl.error({title:e,message:t.status+" text: "+t.statusText,location:"tc"})}})},removeLayer:function(e,t){mappreview.lyrs&&0!=mappreview.lyrs.length||(mappreview.lyrs=[]),jQuery.ajax({url:getGNServiceURL("mapcart.remove"),type:"POST",data:{smallkey:e},success:function(){var r=[];jQuery(mappreview.lyrs).each(function(t,i){i!=e&&r.push(this)});var a=mappreview.lyrs.indexOf(e);if(mappreview.lyrs.splice(a,1),jQuery("#mppl"+e)&&jQuery("#mppl"+e).remove(),jQuery("#mappreview-count").html(r.length),jQuery("#mappreview-link").length>0){var n=jQuery("#mappreview-link").prop("title").replace(/(\d+)/g,r.length);jQuery("#mappreview-link").prop("title",n)}0==r.length&&(jQuery("#mapcart-noitems").show(),jQuery("#mapcart-btn-search-top").hide(),jQuery("#mapcart-btn-clear-top").hide(),jQuery("#mapcart-btn-clear-bottom").hide(),jQuery("#mapcart-btn-view-top").hide(),jQuery("#mapcart-btn-view-bottom").hide(),jQuery("#mapcart-legend").hide(),jQuery("#mapcart-items").hide())},error:function(e){jQuery.growl.error({title:t,message:e.status+" text: "+e.statusText,location:"tc"})}})},test:function(e,t,i){jQuery.ajax({url:getGNServiceURL("mapcart.tester"),type:"POST",success:function(e){jQuery(e).find("item").each(function(){var e=jQuery(this).attr("uuid"),r=jQuery(this).attr("status");"OK"==r?(jQuery("#status-"+e).attr("class","glyphicon glyphicon-ok text-success"),jQuery("#status-"+e).attr("title",t)):(jQuery("#status-"+e).attr("class","glyphicon glyphicon-exclamation-sign text-danger"),jQuery("#status-"+e).attr("title",i))})},error:function(t){jQuery.growl.error({title:e,message:t.status+" text: "+t.statusText,location:"tc"})}})}};
